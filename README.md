Build with Visual Studio 2015. I have tested this fine on Windows 7, Windows 8.1 and Windows 10.
SwitchToThisWindow causes unknown publisher dialogs.

For Flash content, download the PPAPI version of Flash from: https://get.adobe.com/flashplayer/otherversions/